import{v as T,j as e,$ as L,m as D,t as j}from"./app-CLKafMi8.js";import{T as R}from"./trip-info-card-IdTGRMBx.js";import{B as f}from"./button-BjJxCl2U.js";import{C as A,a as F,b as I,c as $,d as E}from"./card-DGsM5wb-.js";import{I as o}from"./input-BZPmkLvt.js";import{L as i}from"./label-CEnKmdYU.js";import{R as P,a as k}from"./radio-group-DakaKEae.js";import{A as q}from"./app-layout-DVg1ib_u.js";import{A as B}from"./arrow-left-BCZ0v28w.js";import{L as G}from"./loader-circle-D3ymHeNZ.js";import"./badge-C6hRO3uT.js";import"./app-logo-icon-Duf-p-hV.js";import"./parse-CaABFq7T.js";import"./format-Dc8-h87M.js";import"./addDays-BIAKPz2e.js";import"./index-DOfCkWky.js";import"./index-DDbGhVyI.js";import"./createLucideIcon-BqkyE-xM.js";import"./index-CbVnBepr.js";import"./index-d59M3VVJ.js";import"./index-YJI3hRqt.js";import"./wrench-BvQdNsdS.js";const S=[{title:"Trips",href:"/vehicles/trips"},{title:"Trip Logs",href:"vehicles/trips/trip-logs"}],V={title:"Create Trip Log",description:"Create a new trip log for a trip."},O=[{value:"excellent",label:"Excellent"},{value:"good",label:"Good"},{value:"fair",label:"Fair"},{value:"poor",label:"Poor"}];function ne({trip:t}){var m,c,n,p,u,x,h,g;const{data:s,setData:l,post:N,errors:a,processing:d,reset:C}=T({trip_id:t.trip_id,received_at:"",departure_time_actual:"",odometer_out:((c=(m=t.vehicle)==null?void 0:m.latest_odometer)==null?void 0:c.odometer_id)||"",odometer_reading:((p=(n=t.vehicle)==null?void 0:n.latest_odometer)==null?void 0:p.reading)||0,pre_trip_condition:""}),b=r=>{var _,v;r.preventDefault();const w={...s,odometer_reading:s.odometer_reading!==((v=(_=t.vehicle)==null?void 0:_.latest_odometer)==null?void 0:v.reading)?s.odometer_reading:void 0};N(route("trip-logs.store"),w,{onSuccess:()=>{j.success("Trip log created successfully"),C()},onError:y=>{console.error("Validation errors:",y),j.error("Failed to create trip log. Please check the form for errors.")}})};return e.jsxs(q,{breadcrumbs:S,pageDetails:V,children:[e.jsx(L,{title:"Create Trip Log"}),e.jsxs(f,{variant:"outline",className:"m-4 w-full bg-white hover:bg-gray-50 sm:w-auto",onClick:()=>D.get(route("trips.show",t.trip_id)),children:[e.jsx(B,{className:"mr-2 h-4 w-4"})," Trip Details"]}),e.jsxs("div",{className:"grid gap-6 px-4 lg:grid-cols-2",children:[e.jsx(R,{trip:t}),e.jsxs(A,{className:"shadow-sm",children:[e.jsxs(F,{className:"",children:[e.jsx(I,{className:"text-lg",children:"Pre-Trip Information"}),e.jsx($,{children:"Record vehicle condition and trip details"})]}),e.jsx(E,{children:e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[e.jsxs("div",{className:"",children:[e.jsxs(i,{htmlFor:"received_at",className:"text-sm font-medium",children:["Received At (Date) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"date",id:"received_at",value:s.received_at,onChange:r=>l("received_at",r.target.value),className:"w-full",required:!0}),a.received_at&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:a.received_at})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"departure_time_actual",className:"text-sm font-medium",children:["Departure Time (Actual) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"time",id:"departure_time_actual",value:s.departure_time_actual,onChange:r=>l("departure_time_actual",r.target.value),className:"w-full",required:!0}),a.departure_time_actual&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:a.departure_time_actual})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"odometer_out",className:"text-sm font-medium",children:["Odometer Reading (Out) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"number",id:"odometer_reading",value:s.odometer_reading,onChange:r=>{l("odometer_reading",r.target.value)},className:"w-full",min:((x=(u=t.vehicle)==null?void 0:u.latest_odometer)==null?void 0:x.reading)||0,placeholder:(g=(h=t.vehicle)==null?void 0:h.latest_odometer)!=null&&g.reading?`Last: ${t.vehicle.latest_odometer.reading} km`:"Enter reading"}),a.odometer_out&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:a.odometer_out})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsxs(i,{className:"text-sm font-medium",children:["Vehicle Condition (Before Trip) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(P,{value:s.pre_trip_condition,onValueChange:r=>l("pre_trip_condition",r),className:"grid grid-cols-2 gap-4 sm:grid-cols-4",required:!0,children:O.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{value:r.value,id:`pre-trip-${r.value}`,className:"border-gray-300 text-emerald-600 focus:ring-emerald-600"}),e.jsx(i,{htmlFor:`pre-trip-${r.value}`,className:"text-sm font-normal",children:r.label})]},r.value))}),a.pre_trip_condition&&e.jsx("p",{className:"text-xs text-red-500",children:a.pre_trip_condition})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(f,{type:"submit",disabled:d,className:"w-full sm:w-auto",children:d?e.jsxs("span",{className:"flex items-center",children:[e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Record"})})]})})]})]})]})}export{ne as default};
