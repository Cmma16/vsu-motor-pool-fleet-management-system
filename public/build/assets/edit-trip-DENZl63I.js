import{j as e,R as v,v as w,t as i,m as E,$ as S}from"./app-CLKafMi8.js";import{D as A}from"./display-table-BRRue0uF.js";import{D as F}from"./destructive-dialog-xP37ESc7.js";import{I as g}from"./input-error-D2Kuilvy.js";import{I as j}from"./input-BZPmkLvt.js";import{L as b}from"./label-CEnKmdYU.js";import{B as p}from"./button-BjJxCl2U.js";import{e as I,f as k,g as L,h as H,i as V,j as O,w as R,X as z,A as U}from"./app-layout-DVg1ib_u.js";import{L as $}from"./loader-circle-D3ymHeNZ.js";import{C as _}from"./crown-D2rAUfyR.js";import{c as q,A as B}from"./index-DJgH2Ra1.js";import{T as M}from"./trip-form-D7M1OrQF.js";import{C as y,a as N,b as C,c as D,d as P}from"./card-DGsM5wb-.js";import{P as X}from"./placeholder-pattern-B2KenmxV.js";import"./index-BCvKXVy8.js";import"./table-BlADWfi2.js";import"./app-logo-icon-Duf-p-hV.js";import"./index-DDbGhVyI.js";import"./createLucideIcon-BqkyE-xM.js";import"./index-DOfCkWky.js";import"./index-CbVnBepr.js";import"./index-YJI3hRqt.js";import"./wrench-BvQdNsdS.js";import"./select-Dh-P3SFY.js";import"./index-d59M3VVJ.js";import"./textarea-i2pfz0MG.js";function G({formData:n,setData:r,processing:s,errors:a}){return e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"name",children:"Name"}),e.jsx(j,{id:"name",type:"text",value:n.name,placeholder:"Enter Passenger Name",onChange:t=>r("name",t.target.value),disabled:s}),e.jsx(g,{message:a.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"affiliation",children:"Department/Office/Center/Project"}),e.jsx(j,{id:"affiliation",type:"text",value:n.affiliation,onChange:t=>r("affiliation",t.target.value),disabled:s,placeholder:"Affiliation",tabIndex:5}),e.jsx(g,{message:a.affiliation})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"contact_number",children:"Contact Number"}),e.jsx(j,{id:"contact_number",type:"text",value:n.contact_number,onChange:t=>r("contact_number",t.target.value),disabled:s,placeholder:"Contact Number",tabIndex:6}),e.jsx(g,{message:a.contact_number})]})]})}function T({trip_id:n,formType:r="add",passenger:s=null}){const[a,t]=v.useState(!1),{data:o,setData:l,post:d,put:h,processing:c,errors:f}=w({trip_id:n??"",name:s?s.name:"",affiliation:s?s.affiliation:"",contact_number:s?s.contact_number:"",is_party_head:s?s.is_party_head:!1});v.useEffect(()=>{s&&(l("name",s.name),l("affiliation",s.affiliation),l("contact_number",s.contact_number),l("is_party_head",s.is_party_head))},[s]);const x=()=>{r==="edit"?h(route("passengers.update",s.id),{onSuccess:()=>{t(!1),i.success("Passenger updated successfully")},onError:m=>{i.error("Failed to update passenger"),console.log(m)}}):d(route("passengers.store"),{onSuccess:()=>{t(!1),i.success("Passenger added successfully")},onError:m=>{i.error("Failed to add passenger"),console.log(m)}})};return e.jsxs(I,{open:a,onOpenChange:t,children:[e.jsx(k,{asChild:!0,children:e.jsx(p,{className:"bg-[#006600] text-white hover:bg-[#005500]",size:"sm",children:r==="edit"?"Edit":"Add"})}),e.jsxs(L,{className:"sm:max-w-[425px]",children:[e.jsxs(H,{children:[e.jsx(V,{children:r==="edit"?"Edit Passenger":"Add Passenger"}),e.jsx(O,{children:r==="edit"?"Edit the passenger details.":"Add a passenger to the trip."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsx(G,{formData:o,setData:l,processing:c,errors:f})}),e.jsx(R,{children:e.jsxs(p,{type:"button",onClick:x,disabled:c,children:[c&&e.jsx($,{className:"mr-2 h-4 w-4 animate-spin"}),r==="edit"?"Save Changes":"Add Passenger"]})})]})]})}const u=q(),J=(n,r,s)=>[{id:"select",enableSorting:!1,enableHiding:!1},u.accessor("is_party_head",{header:()=>e.jsx("div",{className:"text-left"}),cell:a=>e.jsx("div",{className:"flex items-center justify-center text-center",children:a.getValue()?e.jsx(_,{fill:"gold",size:16,className:"text-amber-400"}):a.row.original.trip_status==="pending"&&e.jsx(p,{variant:"ghost",className:"hover:bg-amber-400",onClick:()=>r(a.row.original.id),children:e.jsx(_,{})})})}),u.accessor("name",{header:()=>e.jsxs(p,{variant:"ghost",onClick:()=>column.toggleSorting(column.getIsSorted()==="asc"),children:["Name",e.jsx(B,{className:"ml-2 h-4 w-4"})]}),cell:a=>{const t=a.getValue()||"",o=30,d=t.length>o?t.slice(0,o)+"...":t;return e.jsx("div",{className:"text-left",children:d})}}),u.accessor("affiliation",{header:()=>e.jsx("div",{className:"text-left",children:"Department/Office/Center/Project"}),cell:a=>e.jsx("div",{className:"text-left",children:a.getValue()})}),u.accessor("contact_number",{header:()=>e.jsx("div",{className:"text-left",children:"Contact Number"}),cell:a=>e.jsx("div",{className:"text-left",children:a.getValue()})}),{id:"actions",header:a=>e.jsx("div",{className:"text-center",children:"Actions"}),cell:({row:a})=>{const t=a.original,o=(l,d)=>{if(d){i.warning("This passenger is the party head. Please assign another passenger as party head before deleting.");return}E.delete(route("passengers.destroy",{id:l}),{preserveScroll:!0,onSuccess:()=>{i.success("Passenger deleted successfully")},onError:()=>{i.error("Failed to delete passenger")}})};return t.trip_status!=="pending"?null:e.jsx("div",{className:"flex flex-row justify-center gap-2",children:e.jsx("div",{className:"gap-2",children:e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(T,{trip_id:t.trip_id,formType:"edit",passenger:t}),e.jsx(F,{icon:z,iconOnly:!0,description:"This action cannot be undone.",action:()=>o(t.id,t.is_party_head)})]})})})}}],K=[{title:"Trips",href:"/vehicles/trips"},{title:"Edit",href:"/vehicles/trips/edit-trip"}],Q={title:"Edit Trip Details",description:"Update the details of the trip."};function W(n){E.post(`/passengers/${n}/assign-party-head`,{},{preserveScroll:!0,onSuccess:()=>{i.success("Party head updated successfully")},onError:()=>{i.error("Failed to update party head")}})}function Ce({vehicles:n,users:r,trip:s}){const a=s.departure_time?s.departure_time.substring(0,5):"",{data:t,setData:o,put:l,processing:d,errors:h,reset:c}=w({date_filed:s.date_filed,trip_number:s.trip_number,start_date:s.start_date,end_date:s.end_date,purpose:s.purpose,destination:s.destination,departure_time:a,requesting_party:s.requesting_party,status:s.status}),f=x=>{x.preventDefault(),console.log(t),l(route("trips.update",s.trip_id),{preserveScroll:!0,onSuccess:()=>{i.success("Trip updated successfully"),c()},onError:m=>{i.error("Failed to update trip"),console.log(m)}})};return e.jsxs(U,{breadcrumbs:K,pageDetails:Q,children:[e.jsx(S,{title:"Repairs"}),e.jsxs("div",{className:"mx-6 mb-3 space-y-6 rounded-lg",children:[e.jsxs(y,{className:"w-full",children:[e.jsxs(N,{children:[e.jsx(C,{children:"Trip Information"}),e.jsx(D,{children:"Update the details of the trip."})]}),e.jsx(P,{children:e.jsx(M,{formData:t,formType:"edit",setData:o,onSubmit:f,processing:d,errors:h,vehicles:n,users:r})})]}),e.jsxs(y,{children:[e.jsxs(N,{children:[e.jsx(C,{children:"Passengers"}),e.jsxs(D,{className:"flex justify-between",children:["List of passengers of the trip.",s.status==="pending"&&e.jsx(T,{trip_id:s.trip_id,formType:"add"})]})]}),e.jsx(P,{children:e.jsx(A,{columns:J,data:s.passengers,handleEdit:W,handleView:void 0,handleDelete:void 0})})]})]}),e.jsx("div",{className:"border-sidebar-border/70 dark:border-sidebar-border relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border md:min-h-min",children:e.jsx(X,{className:"absolute inset-0 size-full stroke-neutral-900/20 dark:stroke-neutral-100/20"})})]})}export{Ce as default};
