import{j as e,R as h,v as S,t as g,q as N}from"./app-dmRk_xSF.js";import{D as q}from"./destructive-dialog-B4j_tJwZ.js";import{I as x}from"./input-error-BIGrXHCO.js";import{I as C}from"./input-uEZiaGVz.js";import{L as m}from"./label-tcdczQa9.js";import{S as D,a as E,b as w,c as U,d as j}from"./select-DTbPtvM0.js";import{B as c}from"./button-DfRWLWLh.js";import{e as A,f as I,g as M,h as V,i as F,j as H,w as O}from"./app-layout-CvTHScm8.js";import{c as Q,A as R}from"./index-DOZDu9o9.js";import{T}from"./trash-CUlCQkqn.js";function k({formData:r,setData:l,processing:a,errors:s,parts:i,disablePartSelect:d,part_name:n}){return e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"part_id",children:"Part"}),e.jsxs(D,{disabled:d,value:String(r.part_id),onValueChange:t=>l("part_id",Number(t)),children:[e.jsx(E,{id:"part_id",className:"disabled:border-gray-300 disabled:opacity-100",children:e.jsx(w,{placeholder:"Select part"})}),e.jsx(U,{children:i?i.map(t=>e.jsx(j,{value:String(t.part_id),children:t.part_name},t.part_id)):e.jsx(j,{value:String(r.part_id||"0"),children:n||"Part not found"},r.part_id)})]}),e.jsx(x,{message:s.part_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"quantity_used",children:"Quantity Used"}),e.jsx(C,{id:"quantity_used",type:"number",value:r.quantity_used,onChange:t=>l("quantity_used",t.target.value),disabled:a,placeholder:"Quantity Used",tabIndex:5}),e.jsx(x,{message:s.quantity_used})]})]})}function B({maintenance_id:r,parts:l,formType:a="add",maintenancePart:s=null}){const[i,d]=h.useState(!1),{data:n,setData:t,post:f,put:y,processing:u,errors:b,reset:p}=S({maintenance_id:r??"",part_id:s?s.part_id:"",quantity_used:s?s.quantity_used:"",id:s?s.id:""});h.useEffect(()=>{s&&(t("part_id",s.part_id),t("quantity_used",s.quantity_used),t("id",s.id))},[s]);const v=()=>{a==="edit"?y(route("maintenance-parts.update",s.id),{onSuccess:()=>{g.success("Part usage record updated successfully"),d(!1),p()},onError:o=>console.log(o)}):f(route("maintenance-parts.store"),{onSuccess:()=>{g.success("Part usage record added successfully"),d(!1),p()},onError:o=>console.log(o)})};return e.jsxs(A,{open:i,onOpenChange:d,children:[e.jsx(I,{asChild:!0,children:e.jsx(c,{className:"bg-[#006600] text-white hover:bg-[#005500]",size:"sm",children:a==="edit"?"Edit":"Add"})}),e.jsxs(M,{className:"sm:max-w-[425px]",children:[e.jsxs(V,{children:[e.jsx(F,{children:a==="edit"?"Edit Part Usage":"Add Part Usage"}),e.jsx(H,{children:a==="edit"?"Edit the part usage in the maintenance record.":"Add a part usage to the maintenance record."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsx(k,{formData:n,setData:t,processing:u,errors:b,parts:l,disablePartSelect:a==="edit",part_name:s==null?void 0:s.part_name})}),e.jsx(O,{children:e.jsx(c,{type:"button",onClick:v,disabled:u,children:a==="edit"?"Save Changes":"Add Part Usage"})})]})]})}const _=Q(),P=(r,l,a)=>[{id:"select",enableSorting:!1,enableHiding:!1},_.accessor("part_name",{header:({column:s})=>e.jsxs(c,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Part Name",e.jsx(R,{className:"ml-2 h-4 w-4"})]}),cell:s=>e.jsx("div",{className:"text-left",children:s.getValue()})}),_.accessor("quantity_used",{header:()=>e.jsx("div",{className:"text-left",children:"Quantity Used"}),cell:s=>e.jsx("div",{className:"text-left",children:s.getValue()})}),{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),cell:({row:s})=>{const i=s.original,d=N().props.auth.user;return i.confirmed_by||d.role.name!=="Mechanic"?null:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(B,{maintenance_id:i.maintenance_id,maintenancePart:i,formType:"edit"}),e.jsx(q,{icon:T,iconOnly:!0,description:"This action cannot be undone. This will delete the record permanently.",action:()=>a(i.id)})]})}}];export{B as M,P as a};
