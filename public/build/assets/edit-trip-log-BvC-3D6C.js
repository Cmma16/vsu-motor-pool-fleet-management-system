import{v as A,R as f,j as e,$,m as k,t as b}from"./app-dmRk_xSF.js";import{E as B}from"./edit-odometer-dialog-Cg84cWVU.js";import{B as n}from"./button-DfRWLWLh.js";import{C as y,a as C,b as w,c as R,d as T}from"./card-4lmChtC_.js";import{I as d}from"./input-uEZiaGVz.js";import{L as i}from"./label-tcdczQa9.js";import{R as E,a as O}from"./radio-group-CoyD0JyN.js";import{A as P}from"./app-layout-CvTHScm8.js";import{A as G}from"./arrow-left-Cvya_i_-.js";import{L as z}from"./loader-circle-4vJEE_8H.js";import"./odometer-log-form-Dz18aUlL.js";import"./input-error-BIGrXHCO.js";import"./app-logo-icon-DPhwaTiD.js";import"./select-DTbPtvM0.js";import"./index-Cymawgta.js";import"./createLucideIcon-C6Zxls1X.js";import"./index-BzxzypMb.js";import"./index-DS_s7J1F.js";import"./index-Dnf0Jnlg.js";import"./index-C9jObI59.js";import"./wrench-D44s-QhF.js";const H=[{title:"Trips",href:"/vehicles/trips"},{title:"Trip Logs",href:"vehicles/trips/trip-logs"}],J={title:"Edit Trip Log",description:"Edit the trip log of the selected trip."},D=[{value:"excellent",label:"Excellent"},{value:"good",label:"Good"},{value:"fair",label:"Fair"},{value:"poor",label:"Poor"}];function pe({tripLog:a,trip:c}){var x,h,_,g,v,j;const{data:r,setData:l,put:F,errors:t,processing:m}=A({trip_id:a.trip_id,received_at:a.received_at||"",pre_trip_condition:((x=a.pre_trip_condition)==null?void 0:x.toLowerCase())||"",departure_time_actual:a.departure_time_actual||"",odometer_out:(h=a.odometerOut)==null?void 0:h.odometer_id,odometer_out_reading:((_=a.odometerOut)==null?void 0:_.reading)||0,date_returned:a.date_returned||"",post_trip_condition:((g=a.post_trip_condition)==null?void 0:g.toLowerCase())||"",arrival_time:a.arrival_time||"",odometer_in:(v=a.odometerIn)==null?void 0:v.odometer_id,odometer_in_reading:((j=a.odometerIn)==null?void 0:j.reading)||0}),[I,p]=f.useState(!1),[S,V]=f.useState(null),u=s=>{V(s),p(!0)},q=s=>{s.preventDefault(),console.log("Form submission started"),console.log("Current form data:",r),console.log("Form validation state:",Object.keys(t).length>0?t:"No validation errors");const o={...r};delete o.odometer_out_reading,delete o.odometer_in_reading,console.log("Submitting data to server:",o),console.log("Route being called:",route("trip-logs.update",a.trip_log_id)),F(route("trip-logs.update",a.trip_log_id),o,{onSuccess:()=>{console.log("Submission successful"),b.success("Trip log updated successfully")},onError:N=>{console.log("Submission failed with errors:",N),b.error("Failed to update trip log"),console.log("Validation errors:",N)}})};return e.jsxs(P,{breadcrumbs:H,pageDetails:J,children:[e.jsx($,{title:"Complete Trip Log"}),e.jsxs("div",{className:"space-y-6 px-4 pb-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(n,{variant:"outline",className:"w-full bg-white hover:bg-gray-50 sm:w-auto",onClick:()=>k.get(route("trips.show",c.trip_id)),children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Back to Trip Details"]})}),e.jsx(B,{isOpen:I,onOpenChange:p,editingLog:S,vehicles:[c.vehicle]}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(y,{className:"shadow-sm",children:[e.jsx(C,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsx(w,{className:"text-lg",children:"Pre-Trip Information"}),e.jsx(R,{children:"Record vehicle condition and details before the trip"})]})})}),e.jsx(T,{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"received_at",className:"text-sm font-medium",children:["Date Received ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{type:"date",id:"received_at",value:r.received_at,onChange:s=>l("received_at",s.target.value),className:"w-full",required:!0}),t.received_at&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.received_at})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"departure_time",className:"text-sm font-medium",children:["Departure Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{type:"time",id:"departure_time_actual",value:r.departure_time_actual,onChange:s=>l("departure_time_actual",s.target.value),className:"w-full",required:!0}),t.departure_time_actual&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.departure_time_actual})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"odometer_out_reading",className:"text-sm font-medium",children:["Odometer Reading (Out) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(d,{type:"number",id:"odometer_out_reading",value:r.odometer_out_reading,onChange:s=>l("odometer_out_reading",s.target.value),disabled:!0,className:"disabled:bg-gray-500 disabled:opacity-100"}),e.jsx(n,{variant:"outline",type:"button",onClick:()=>u(a.odometerOut),children:"Edit"})]}),t.odometer_out&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.odometer_out})]}),e.jsxs("div",{className:"col-span-full space-y-3",children:[e.jsxs(i,{className:"text-sm font-medium",children:["Vehicle Condition (Before Trip) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(E,{defaultValue:r.pre_trip_condition,value:r.pre_trip_condition,onValueChange:s=>l("pre_trip_condition",s),className:"grid grid-cols-2 gap-4 sm:grid-cols-4",required:!0,children:D.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{value:s.value,id:`pre-trip-${s.value}`,className:"border-gray-300 text-emerald-600 focus:ring-emerald-600"}),e.jsx(i,{htmlFor:`pre-trip-${s.value}`,className:"text-sm font-normal",children:s.label})]},s.value))}),t.pre_trip_condition&&e.jsx("p",{className:"text-xs text-red-500",children:t.pre_trip_condition})]})]})})})]}),e.jsxs(y,{className:"shadow-sm",children:[e.jsx(C,{className:"border-b border-gray-100 bg-gray-50/50",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsx(w,{className:"text-lg",children:"Post-Trip Information"}),e.jsx(R,{children:"Record vehicle condition and details after the trip"})]})})}),e.jsx(T,{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"date_returned",className:"text-sm font-medium",children:["Date Returned ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{type:"date",id:"date_returned",value:r.date_returned,onChange:s=>l("date_returned",s.target.value),className:"w-full",required:!0}),t.date_returned&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.date_returned})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"arrival_time",className:"text-sm font-medium",children:["Arrival Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{type:"time",id:"arrival_time",value:r.arrival_time,onChange:s=>l("arrival_time",s.target.value),className:"w-full",required:!0}),t.arrival_time&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.arrival_time})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"odometer_in_reading",className:"text-sm font-medium",children:["Odometer Reading (In) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(d,{type:"number",id:"odometer_in_reading",value:r.odometer_in_reading,onChange:s=>l("odometer_in_reading",s.target.value),disabled:!0,className:"disabled:bg-gray-500 disabled:opacity-100"}),e.jsx(n,{size:"sm",variant:"outline",type:"button",onClick:()=>u(a.odometerIn),children:"Edit"})]}),t.odometer_in&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.odometer_in})]}),e.jsxs("div",{className:"col-span-full space-y-3",children:[e.jsxs(i,{className:"text-sm font-medium",children:["Vehicle Condition (After Trip) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(E,{defaultValue:r.post_trip_condition,value:r.post_trip_condition,onValueChange:s=>l("post_trip_condition",s),className:"grid grid-cols-2 gap-4 sm:grid-cols-4",required:!0,children:D.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{value:s.value,id:`post-trip-${s.value}`,className:"border-gray-300 text-emerald-600 focus:ring-emerald-600"}),e.jsx(i,{htmlFor:`post-trip-${s.value}`,className:"text-sm font-normal",children:s.label})]},s.value))}),t.post_trip_condition&&e.jsx("p",{className:"text-xs text-red-500",children:t.post_trip_condition})]})]})})})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(n,{type:"submit",disabled:m,className:"w-full bg-emerald-600 hover:bg-emerald-700 sm:w-auto",children:m?e.jsxs("span",{className:"flex items-center",children:[e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Save changes"})})]})]})]})}export{pe as default};
