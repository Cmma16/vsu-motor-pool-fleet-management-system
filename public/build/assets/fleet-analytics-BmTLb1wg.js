import{q as A,v as R,r as y,j as e,$ as w,m as D,t as K}from"./app-dmRk_xSF.js";import{M as d,T as M,a as P}from"./trip-chart-CvYSPaR1.js";import{P as V}from"./part-inventory-chart-BVS7sxmN.js";import{B as g}from"./button-DfRWLWLh.js";import{C as k,a as E,b as Y,d as q}from"./card-4lmChtC_.js";import{I as _}from"./input-uEZiaGVz.js";import{L as c}from"./label-tcdczQa9.js";import{S as h,a as m,b as u,c as x,d as p}from"./select-DTbPtvM0.js";import{A as I,M as J}from"./app-layout-CvTHScm8.js";import{C as L}from"./car-DrIISSj-.js";import{W as O}from"./wrench-D44s-QhF.js";import{F as W}from"./filter-DMEUe8Yj.js";import{C as N}from"./calendar-D08P4PnK.js";import"./createLucideIcon-C6Zxls1X.js";import"./generateCategoricalChart-4O1V2zK5.js";import"./app-logo-icon-DPhwaTiD.js";import"./index-CJBnmqfT.js";import"./BarChart-B-AccRzR.js";import"./chart-cy_Gs8DH.js";import"./index-DS_s7J1F.js";import"./index-Cymawgta.js";import"./index-BzxzypMb.js";import"./index-Dnf0Jnlg.js";import"./index-C9jObI59.js";const $=[{title:"Reports",href:"/reports"}],B={title:"Fleet Analytics",description:"Comprehensive analytics and insights about your fleet operations."},H=[{value:"0",label:"All month"},{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}],f=new Date().getFullYear(),z=Array.from({length:6},(b,s)=>({value:(f-s).toString(),label:(f-s).toString()})),v={trip:{label:"Trip Analytics",chartTitle:"Trips by Vehicle",chartDescription:"Number of completed trips per vehicle",barKey:"total",xKey:"vehicle_name",reportType:"Trips"},repair:{label:"Repair Analytics",chartTitle:"Repairs by Vehicle",chartDescription:"Number of repairs conducted per vehicle",barKey:"total",xKey:"vehicle_name",reportType:"Repairs"},preventive:{label:"Preventive Maintenance Analytics",chartTitle:"Preventive Maintenance by Vehicle",chartDescription:"Number of preventive maintenance services per vehicle",barKey:"total",xKey:"vehicle_name",reportType:"Preventive"}};function ge({resultData:b,metrics:s,parts:n}){const{vehicles:G,filters:t}=A().props,{data:l,setData:i,get:T,processing:r}=R({start_date:(t==null?void 0:t.start_date)||"",end_date:(t==null?void 0:t.end_date)||"",month:(t==null?void 0:t.month)||"",year:(t==null?void 0:t.year)||"",vehicle_ids:(t==null?void 0:t.vehicle_ids)||[],report_type:(t==null?void 0:t.report_type)||""}),[C,j]=y.useState(!1),o=v[t==null?void 0:t.report_type]||v.trip;y.useEffect(()=>{const a=l.start_date!==((t==null?void 0:t.start_date)||"")||l.end_date!==((t==null?void 0:t.end_date)||"")||l.month!==((t==null?void 0:t.month)||"")||l.year!==((t==null?void 0:t.year)||"")||l.report_type!==((t==null?void 0:t.report_type)||"");j(a)},[l,t]);const S=a=>{a.preventDefault(),T(route("reports.fleet"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{K.success("Filter successfully applied"),j(!1)}})};return e.jsxs(I,{breadcrumbs:$,pageDetails:B,children:[e.jsx(w,{title:"Reports"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(d,{title:"Total Trips",value:s.total_trips,description:"Total number of trips completed",icon:J}),e.jsx(d,{title:"Total Vehicles",value:s.total_vehicles,description:"Total number of vehicles in fleet",icon:L}),e.jsx(d,{title:"Service Requests",value:s.total_requests,description:"Total number of service requests",icon:O}),e.jsx(d,{title:"Most Active Vehicle",value:s.most_active_vehicle.name,description:`${s.most_active_vehicle.trips} trips completed`,icon:M})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-xl bg-white p-3 lg:col-span-4",children:[e.jsx(c,{htmlFor:"report_type",children:"Report Type"}),e.jsxs(h,{id:"report_type",value:l.report_type,onValueChange:a=>i("report_type",a),disabled:r,children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Select report type"})}),e.jsx(x,{children:Object.entries(v).map(([a,F])=>e.jsx(p,{value:a,children:F.label},a))})]})]}),e.jsxs(k,{children:[e.jsx(E,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),e.jsx(Y,{children:"Filter Reports"})]})}),e.jsx(q,{children:e.jsxs("form",{onSubmit:S,className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"start_date",children:"Start Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"text-muted-foreground absolute top-2.5 left-3 h-4 w-4"}),e.jsx(_,{id:"start_date",type:"date",value:l.start_date,onChange:a=>i("start_date",a.target.value),className:"pl-9",disabled:r})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"end_date",children:"End Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(N,{className:"text-muted-foreground absolute top-2.5 left-3 h-4 w-4"}),e.jsx(_,{id:"end_date",type:"date",value:l.end_date,onChange:a=>i("end_date",a.target.value),className:"pl-9",disabled:r})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"month",children:"Month"}),e.jsxs(h,{value:l.month,onValueChange:a=>i("month",a),disabled:r,children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Select month"})}),e.jsx(x,{children:H.map(a=>e.jsx(p,{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"year",children:"Year"}),e.jsxs(h,{value:l.year,onValueChange:a=>i("year",a),disabled:r,children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Select year"})}),e.jsxs(x,{children:[e.jsx(p,{value:"0",children:"All Years"},"0"),z.map(a=>e.jsx(p,{value:a.value,children:a.label},a.value))]})]})]}),e.jsxs("div",{className:"col-span-full flex justify-end gap-2",children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>D.get("/reports/fleet-analytics"),className:"w-full md:w-auto",disabled:r,children:"Reset Filters"}),e.jsx(g,{type:"submit",className:"w-full md:w-auto",disabled:r||!C,children:r?"Applying...":"Apply Filters"})]})]})})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-7",children:e.jsx("div",{className:"col-span-full",children:e.jsx(P,{tripData:b,barKey:o.barKey,xKey:o.xKey,report_type:o.reportType,chartTitle:o.chartTitle,chartDescription:o.chartDescription})})}),e.jsx(V,{parts:n}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"rounded-lg border bg-white p-4",children:[e.jsx("h4",{className:"font-semibold text-green-600",children:"Well Stocked"}),e.jsx("p",{className:"text-2xl font-bold",children:n.filter(a=>a.current_stock>a.restock_threshold).length}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"parts above threshold"})]}),e.jsxs("div",{className:"rounded-lg border bg-white p-4",children:[e.jsx("h4",{className:"font-semibold text-red-600",children:"Need Restocking"}),e.jsx("p",{className:"text-2xl font-bold",children:n.filter(a=>a.current_stock<=a.restock_threshold).length}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"parts below threshold"})]}),e.jsxs("div",{className:"rounded-lg border bg-white p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-600",children:"Total Parts"}),e.jsx("p",{className:"text-2xl font-bold",children:n.length}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"in inventory"})]})]})]})]})}export{ge as default};
