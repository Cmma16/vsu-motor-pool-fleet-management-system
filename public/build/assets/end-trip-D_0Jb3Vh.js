import{v as y,j as e,$ as L,m as R,t as j}from"./app-CLKafMi8.js";import{T as D}from"./trip-info-card-IdTGRMBx.js";import{B as f}from"./button-BjJxCl2U.js";import{C as A,a as E,b as F,c as I,d as $}from"./card-DGsM5wb-.js";import{I as o}from"./input-BZPmkLvt.js";import{L as i}from"./label-CEnKmdYU.js";import{R as q,a as G}from"./radio-group-DakaKEae.js";import{A as P}from"./app-layout-DVg1ib_u.js";import{A as S}from"./arrow-left-BCZ0v28w.js";import{L as k}from"./loader-circle-D3ymHeNZ.js";import"./badge-C6hRO3uT.js";import"./app-logo-icon-Duf-p-hV.js";import"./parse-CaABFq7T.js";import"./format-Dc8-h87M.js";import"./addDays-BIAKPz2e.js";import"./index-DOfCkWky.js";import"./index-DDbGhVyI.js";import"./createLucideIcon-BqkyE-xM.js";import"./index-CbVnBepr.js";import"./index-d59M3VVJ.js";import"./index-YJI3hRqt.js";import"./wrench-BvQdNsdS.js";const B=[{title:"Trips",href:"/vehicles/trips"},{title:"Trip Logs",href:"vehicles/trips/trip-logs"}],O={title:"End Trip",description:"Record post-trip information to complete the trip."},V=[{value:"excellent",label:"Excellent"},{value:"good",label:"Good"},{value:"fair",label:"Fair"},{value:"poor",label:"Poor"}];function ce({trip:s,tripLog:N}){var m,n,c,p,x,u,h,g;const{data:a,setData:l,post:C,errors:t,processing:d}=y({date_returned:"",post_trip_condition:"",arrival_time:"",odometer_in:((n=(m=s.vehicle)==null?void 0:m.latest_odometer)==null?void 0:n.odometer_id)||"",odometer_reading:((p=(c=s.vehicle)==null?void 0:c.latest_odometer)==null?void 0:p.reading)||0}),b=r=>{var v,_;r.preventDefault();const T={...a,odometer_reading:a.odometer_reading!==((_=(v=s.vehicle)==null?void 0:v.latest_odometer)==null?void 0:_.reading)?a.odometer_reading:void 0};C(route("trip-logs.complete",N.trip_log_id),T,{onSuccess:()=>{reset(),j.success("Trip completed successfully")},onError:w=>{j.error("Failed to complete trip"),console.log(w.message)}})};return e.jsxs(P,{breadcrumbs:B,pageDetails:O,children:[e.jsx(L,{title:"End Trip"}),e.jsxs(f,{variant:"outline",className:"m-4 w-full bg-white hover:bg-gray-50 sm:w-auto",onClick:()=>R.get(route("trips.show",s.trip_id)),children:[e.jsx(S,{className:"mr-2 h-4 w-4"})," Trip Details"]}),e.jsxs("div",{className:"grid gap-6 px-4 lg:grid-cols-2",children:[e.jsx(D,{trip:s}),e.jsxs(A,{className:"shadow-sm",children:[e.jsxs(E,{className:"",children:[e.jsx(F,{className:"text-lg",children:"Post-Trip Information"}),e.jsx(I,{children:"Record vehicle condition and trip details"})]}),e.jsx($,{children:e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[e.jsxs("div",{className:"",children:[e.jsxs(i,{htmlFor:"date_returned",className:"text-sm font-medium",children:["Date Returned ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"date",id:"date_returned",value:a.date_returned,onChange:r=>l("date_returned",r.target.value),className:"w-full",required:!0}),t.date_returned&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.date_returned})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"arrival_time",className:"text-sm font-medium",children:["Arrival Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"time",id:"arrival_time",value:a.arrival_time,onChange:r=>l("arrival_time",r.target.value),className:"w-full",required:!0}),t.arrival_time&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.arrival_time})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"odometer_out",className:"text-sm font-medium",children:["Odometer Reading (Out) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{type:"number",id:"odometer_reading",value:a.odometer_reading,onChange:r=>{l("odometer_reading",r.target.value)},className:"w-full",min:((u=(x=s.vehicle)==null?void 0:x.latest_odometer)==null?void 0:u.reading)||0,placeholder:(g=(h=s.vehicle)==null?void 0:h.latest_odometer)!=null&&g.reading?`Last: ${s.vehicle.latest_odometer.reading} km`:"Enter reading"}),t.odometer_in&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:t.odometer_in})]}),e.jsxs("div",{className:"col-span-full space-y-3",children:[e.jsxs(i,{className:"text-sm font-medium",children:["Vehicle Condition (After Trip) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(q,{value:a.post_trip_condition,onValueChange:r=>l("post_trip_condition",r),className:"grid grid-cols-2 gap-4 sm:grid-cols-4",required:!0,children:V.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{value:r.value,id:`post-trip-${r.value}`,className:"border-gray-300 text-emerald-600 focus:ring-emerald-600"}),e.jsx(i,{htmlFor:`post-trip-${r.value}`,className:"text-sm font-normal",children:r.label})]},r.value))}),t.post_trip_condition&&e.jsx("p",{className:"text-xs text-red-500",children:t.post_trip_condition})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(f,{type:"submit",disabled:d,className:"w-full sm:w-auto",children:d?e.jsxs("span",{className:"flex items-center",children:[e.jsx(k,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Record Trip Completion"})})]})})]})]})]})}export{ce as default};
