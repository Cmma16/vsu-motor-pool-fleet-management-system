import{r as S,j as e,t as m,R as F,v as H,$ as R}from"./app-dmRk_xSF.js";import{B as j}from"./button-DfRWLWLh.js";import{C as P,a as T,b as w,c as k,d as A,e as L}from"./card-4lmChtC_.js";import{C}from"./checkbox-DSKKP5CO.js";import{I as v}from"./input-uEZiaGVz.js";import{L as y}from"./label-tcdczQa9.js";import{T as I,a as M,b as N,c as p,d as B,e as h}from"./table-CfditYzf.js";import{P as D}from"./plus-C3GojSzG.js";import{c as E}from"./createLucideIcon-C6Zxls1X.js";import{L as O}from"./loader-circle-4vJEE_8H.js";import{T as q}from"./trip-form-CEuedAKH.js";import{A as z}from"./app-layout-CvTHScm8.js";import{f as V}from"./format-B8Iw8-x-.js";import"./app-logo-icon-DPhwaTiD.js";import"./index-Cymawgta.js";import"./index-Dnf0Jnlg.js";import"./index-C9jObI59.js";import"./index-DS_s7J1F.js";import"./input-error-BIGrXHCO.js";import"./textarea-ENukNeqr.js";import"./index-BzxzypMb.js";import"./wrench-D44s-QhF.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],G=E("Trash2",$);function J({formData:t,setData:d,onPreviousStep:l,onSubmit:u,isSubmitting:c}){var g,f;const[r,i]=S.useState({name:"",affiliation:"",contact_number:"",is_party_head:!1}),x=()=>{if(!r.name)return;let s=[...t.passengers||[]];r.is_party_head&&(s=s.map(a=>({...a,is_party_head:!1}))),s.push(r),d("passengers",s),m.success("Passenger added successfully"),i({name:"",affiliation:"",contact_number:"",is_party_head:!1})},_=s=>{const a=t.passengers.filter((n,o)=>o!==s);d("passengers",a),m.success("Passenger removed successfully")},b=s=>{const a=t.passengers.map((n,o)=>({...n,is_party_head:o===s?!n.is_party_head:!1}));d("passengers",a),m.success("Party head changed successfully")};return e.jsxs(P,{children:[e.jsxs(T,{children:[e.jsx(w,{children:"Passenger Information"}),e.jsx(k,{children:"Add all passengers who will be traveling"})]}),e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"passenger-name",children:"Passenger Name"}),e.jsx(v,{id:"passenger-name",placeholder:"Full name",value:r.name,onChange:s=>i({...r,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"passenger_affiliation",children:"Department/Office/Center/Project"}),e.jsx(v,{id:"passenger_affiliation",type:"text",placeholder:"Department/Office/Center/Project",value:r.affiliation,onChange:s=>i({...r,affiliation:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"contact_number",children:"Contact Number"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{id:"contact_number",placeholder:"Contact number",value:r.contact_number,onChange:s=>i({...r,contact_number:s.target.value})}),e.jsx(j,{type:"button",onClick:x,disabled:!r.name,size:"icon",children:e.jsx(D,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{id:"is_party_head",checked:r.is_party_head,onCheckedChange:s=>{var a;s&&((a=t.passengers)!=null&&a.some(n=>n.is_party_head))||i({...r,is_party_head:s})}}),e.jsx(y,{htmlFor:"is_party_head",children:"Party Head"})]}),((g=t.passengers)==null?void 0:g.length)>0?e.jsxs(I,{children:[e.jsx(M,{children:e.jsxs(N,{children:[e.jsx(p,{children:"Name"}),e.jsx(p,{children:"Department/Office"}),e.jsx(p,{children:"Contact Number"}),e.jsx(p,{className:"w-[100px]",children:"Party Head"}),e.jsx(p,{className:"w-[70px]",children:"Actions"})]})}),e.jsx(B,{children:t.passengers.map((s,a)=>e.jsxs(N,{children:[e.jsx(h,{children:s.name}),e.jsx(h,{children:s.affiliation}),e.jsx(h,{children:s.contact_number}),e.jsx(h,{children:e.jsx(C,{checked:s.is_party_head,onCheckedChange:()=>b(a),disabled:t.passengers.some((n,o)=>o!==a&&n.is_party_head)})}),e.jsx(h,{children:e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>_(a),children:e.jsx(G,{className:"text-destructive h-4 w-4"})})})]},a))})]}):e.jsx("div",{className:"text-muted-foreground py-4 text-center",children:"No passengers added yet. Add at least one passenger to continue."})]}),e.jsxs(L,{className:"flex justify-between",children:[e.jsx(j,{variant:"outline",onClick:l,children:"Back to Trip Details"}),e.jsx(j,{onClick:u,disabled:!((f=t.passengers)!=null&&f.length)||c||!t.passengers.some(s=>s.is_party_head),children:c?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Trip Request"})]})]})}const K=[{title:"Trips",href:"/vehicles/trips"},{title:"New trip",href:"vehicles/trips/add-trip"}],Q={title:"Add New Trip",description:"Record the details of a vehicle trip."};function fe({vehicles:t,users:d}){const[l,u]=F.useState(1),{data:c,setData:r,post:i,processing:x,errors:_,reset:b}=H({date_filed:V(new Date,"yyyy-MM-dd"),trip_number:"",start_date:"",end_date:"",purpose:"",destination:"",departure_time:"",requesting_party:"",passengers:[]}),g=a=>{a.preventDefault(),u(n=>n+1)},f=()=>{u(a=>a-1)},s=a=>{a.preventDefault(),i(route("trips.store"),{data:c},{onSuccess:()=>{m.success("Trip added successfully"),b()},onError:n=>{m.error("Failed to add trip"),console.log(n)}})};return e.jsxs(z,{breadcrumbs:K,pageDetails:Q,children:[e.jsx(R,{title:"Add New Trip"}),e.jsx("div",{className:"mx-6 mb-3 space-y-6 rounded-lg bg-white",children:e.jsxs(P,{children:[e.jsxs(T,{children:[e.jsx(w,{children:l===1?"Trip Details":"Passenger Information"}),e.jsx(k,{children:l===1?"Provide the necessary information for the trip.":"Add all passengers who will be traveling"})]}),e.jsx(A,{children:l===1?e.jsx(q,{formData:c,setData:r,onSubmit:g,processing:x,errors:_,vehicles:t,users:d,formType:"create"}):e.jsx(J,{formData:c,setData:r,onPreviousStep:f,onSubmit:s,isSubmitting:x})})]})})]})}export{fe as default};
