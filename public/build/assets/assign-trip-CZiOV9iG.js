import{r as d,v as w,j as e,$ as T,m as u,t as i}from"./app-CLKafMi8.js";import{T as y}from"./trip-info-card-IdTGRMBx.js";import{B as c}from"./button-BjJxCl2U.js";import{C as F,a as D,b as L,c as E,d as I,e as k}from"./card-DGsM5wb-.js";import{L as x}from"./label-CEnKmdYU.js";import{S as g,a as f,b as j,c as v,d as _}from"./select-Dh-P3SFY.js";import{S as H}from"./separator-BPS_s0RH.js";import{A as R}from"./app-layout-DVg1ib_u.js";import{A as V}from"./arrow-left-BCZ0v28w.js";import{L as S}from"./loader-circle-D3ymHeNZ.js";import{f as q}from"./format-Dc8-h87M.js";import{p as B}from"./parse-CaABFq7T.js";import"./badge-C6hRO3uT.js";import"./app-logo-icon-Duf-p-hV.js";import"./index-DOfCkWky.js";import"./index-DDbGhVyI.js";import"./createLucideIcon-BqkyE-xM.js";import"./index-CbVnBepr.js";import"./index-d59M3VVJ.js";import"./index-YJI3hRqt.js";import"./wrench-BvQdNsdS.js";import"./addDays-BIAKPz2e.js";const $=[{title:"Trips",href:"/vehicles/trips"},{title:"Assign Trip",href:"vehicles/trips/assign-trip"}],U={title:"Assign Trip",description:"Assign a driver and vehicle to the trip."};function he({trip:r,availableVehicles:o,availableDrivers:m}){const[a,l]=d.useState(!1),[z,G]=d.useState(!1),[p,J]=d.useState(null),{data:t,setData:h,put:C,reset:N}=w({trip_number:r.trip_number,date_filed:r.date_filed,start_date:r.start_date,end_date:r.end_date,purpose:r.purpose,destination:r.destination,departure_time:q(B(r.departure_time,"HH:mm:ss",new Date),"h:mm"),requesting_party:r.requesting_party,status:r.status,driver_id:"",vehicle_id:""}),A=s=>{l(!0),s.preventDefault(),console.log(t),C(route("trips.update",r.trip_id),{preserveScroll:!0,onSuccess:()=>{i.success("Trip assigned successfully"),N(),l(!1)},onError:n=>{i.error("Failed to assign trip"),console.log(n),l(!1)}})},b=(s,n)=>{u.patch(route("trips.updateStatus",s),{status:n},{preserveScroll:!0,onSuccess:()=>{i("Trip status updated successfully")},onError:()=>{i("Failed to update trip status")}})};return e.jsxs(R,{breadcrumbs:$,pageDetails:U,children:[e.jsx(T,{title:"Assign Trip"}),e.jsxs(c,{variant:"outline",className:"mx-4 self-start bg-white",onClick:()=>u.get(route("trips.show",r.trip_id)),children:[e.jsx(V,{})," Trip Details"]}),e.jsxs("div",{className:"mb-8 grid gap-6 p-4 md:grid-cols-2",children:[e.jsx(y,{trip:r}),e.jsxs(F,{className:"flex-1",children:[e.jsxs(D,{children:[e.jsx(L,{children:"Assignment"}),e.jsx(E,{children:"Select an available driver and vehicle"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"driver",children:"Driver"}),e.jsxs(g,{value:t.driver_id,onValueChange:s=>h("driver_id",s),children:[e.jsx(f,{id:"driver",children:e.jsx(j,{placeholder:"Select a driver"})}),e.jsxs(v,{children:[e.jsx("div",{className:"flex flex-row gap-2",children:e.jsxs("p",{className:"text-muted-foreground",children:["Showing ",m.length," available drivers"]})}),m.map(s=>e.jsxs(_,{value:s.id,children:[s.first_name," ",s.last_name]},s.id))]})]})]}),e.jsx(H,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"vehicle",children:"Vehicle"}),e.jsxs(g,{value:t.vehicle_id,onValueChange:s=>h("vehicle_id",s),children:[e.jsx(f,{id:"vehicle",children:e.jsx(j,{placeholder:"Select a vehicle"})}),e.jsxs(v,{children:[e.jsx("div",{className:"flex flex-row gap-2",children:e.jsxs("p",{className:"text-muted-foreground",children:["Showing ",o.length," available vehicles"]})}),o.map(s=>e.jsxs(_,{value:s.vehicle_id,children:[s.vehicle_name," (",s.vehicle_type,") - ",s.capacity," passengers"]},s.vehicle_id))]})]})]})]}),e.jsxs(k,{className:"flex flex-row gap-2",children:[e.jsx(c,{className:"w-full",onClick:A,disabled:!t.driver_id||!t.vehicle_id||a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Assigning..."]}):"Confirm Assignment"}),e.jsx(c,{className:"w-full",variant:"destructive",onClick:()=>b(r.trip_id,"rejected"),disabled:a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Rejecting..."]}):"Reject Trip"})]})]}),p&&e.jsx("p",{className:"text-red-500",children:p})]})]})}export{he as default};
